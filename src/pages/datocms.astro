---
const query = `
query MyQuery {
  allSomethings {
    foo
    id
    _modelApiKey
  }
}
`
const accessToken = import.meta.env.DATOCMS_TOKEN

const url = Astro.url.origin + "/.netlify/functions/datocms-proxy"

console.log("url", url);


const headers = new Headers()
headers.append("Content-Type", "application/json");

const body = JSON.stringify({query, accessToken})

console.log("body astro", body);


const content = await fetch(url, {
  headers,
  body,
  method: "POST"
}).then(response => {
  console.log("response", response);
  
  return response.json()
})
---
<pre>
  {JSON.stringify(content, null, 2)}
</pre>